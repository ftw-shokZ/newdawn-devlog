---
layout: post
title: "OpenMP Migration & Deathlist Madness"
date: 2025-05-29
thumbnail: /newdawn-devlog/assets/thumbs/post-5.png
tags: [Clanwar, Deathlist, OpenMP, Migration, Debugspeare]
---

> *‚ÄúThou shall not pass unless your code compiles.‚Äù*  
> ‚Äî William Debugspeare, moments before the OpenMP migration

---

## üõ†Ô∏è Devblog: May 29th ‚Äì *OpenMP, Deathlist & DebugHell*

Today‚Äôs entry is a spicy cocktail of **DeathList redesign**, **OpenMP migration**, and a bucketload of **compiler tantrums**. What began as a simple update turned into a holy crusade against untagged variables, deprecated functions, and the eternal battle of `0` vs. `false`.

---

### üíÄ Deathlist TextDraw System ‚Äì *Now Longer, Stronger, and Ranked in Style*

- Fully reworked with `CreateDeathListTD()`.
- Each kill now shifts the list downward via `PushDeathListEntry(playerid, tick)`.
- **Top 3** entries are color-highlighted (for that sweet, glorious shame).
- Built-in ordinal formatting (1st, 2nd, 3rd, etc.) so even in death, you're properly labeled.
- Handles eliminations with `HandlePlayerElimination(playerid)` and closes rounds with `HandleRoundWinner(type)`.

> Everyone dies. But not everyone makes the list.

---

### üß† Clanwar Scoreboard Logic ‚Äì *Smart, Reactive, and Sassier*

- We now dynamically update the HUD based on `CWInfo[MapRoundsLeft]`.
- Status strings include:
  - `~r~No map selected. Please wait.`
  - `~y~Selecting next map...`
  - `~w~Rounds left: ~y~%d`
- Seamless round-to-round transitions. Cleaner than ever.

---

### ‚è±Ô∏è New Map Timer ‚Äì *Finally, a Clock!*

- Introduced a **map-specific timer** to Clanwars.
- Tracks overall match duration and per-round timings.

> We finally have a timer. Took us only 10 years. Now you know how long you‚Äôve been stuck on that one map. Worth it.

---

### üîÅ Map Search Overhaul ‚Äì *Tablist + Filtering*

- Implemented `DIALOG_STYLE_TABLIST_HEADERS` with author, mode, and mapname columns.
- Searches `.ini` files from `/RMaps/` dynamically.
- Added full **Search Map** support with partial name matching.

---

### üî• OpenMP Migration ‚Äì *Welcome to the Shittery*

Oh boy. Where do we begin?

We switched the engine from SA-MP to OpenMP and **all hell broke loose**:

- `if(0)`? Now must be `if(false)`.
- `TextDrawColor`? Replaced with `TextDrawColour`. British server confirmed.
- `TogglePlayerControllable(playerid, 1);` ‚Üí **tag mismatch**  
  Use `true`. Apparently, 1.0 is too ambiguous for this brave new world.

---

### ü§ï The Migration Warnings That Haunted Us

- warning 213: tag mismatch  
- warning 234: function is deprecated (GetPlayerPoolSize)  
- error 025: function heading differs from prototype  
  *"Bro, you forgot the enum tag on 'reason' again..."*

We slapped on every fix possible:

```pawn
#define NO_TAGS  
#define MIXED_SPELLINGS  
#include <open.mp>  
#pragma warning disable 213  
```

---

### üß™ Runtime Errors & Logs of Doom

> "Status 406 ‚Äî socket read timed out"  
> [Info] This won‚Äôt affect server behavior.

Well, thank god ‚Äî because after that refactor, we were *this* close to switching careers.

Also:

- `GetPlayerPoolSize()` ‚Üí `MAX_PLAYERS`
- `GetVehiclePoolSize()` ‚Üí `MAX_VEHICLES`

---

### üßº The Cleaners: *Reset & Round Control*

- `ResetDeathList()` wipes the board between rounds.
- `HandlePlayerElimination()` manages active deaths.
- `HandleRoundWinner(type)` finalizes the round based on alive counts.

The round system is now smarter, cleaner, and battle-tested.

---

### üåü Achievement System Preview ‚Äì *Sneak Peek from the CW Server*

We also previewed an early concept for the **new Achievement System**, planned for the main server.

- Tested a working prototype on the CW server.
- Features dynamic TextDraws for titles, rewards, and notifications.
- Integrated sound feedback

It‚Äôs still early ‚Äî but already spicy. Expect more soon.

---

## üì∏ Screenshots

**Achievement System**  
![Achievement](https://ftw-shokz.github.io/newdawn-devlog/assets/achievement.png)

**Deathlist**  
![Deathlist](https://ftw-shokz.github.io/newdawn-devlog/assets/deathlist.png)

**Map Search Dialog**  
![Maplist](https://ftw-shokz.github.io/newdawn-devlog/assets/maplist.png)

**Map Timer**  
![Maptimer](https://ftw-shokz.github.io/newdawn-devlog/assets/maptimer.png)

---

> *‚ÄúTag your enums, sanitize your inputs, and may your returns never be void.‚Äù*  
> ‚Äî Debugspeare

Catch you next push.  
‚Äî Jonny
